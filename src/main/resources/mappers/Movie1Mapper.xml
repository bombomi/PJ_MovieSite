<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Movie1Mapper">
<select id="selectPlaceByMovie" resultType="com.movie.mymovie.dto.TheaterDto" parameterType="String">
	 SELECT THEATER_ADDR
	 FROM THEATER, TIMETABLE
	 WHERE TIMETABLE.MOVIE_ID=#{movie_id} AND TIMETABLE.THEATER_ID=THEATER.THEATER_ID
	</select>


<select id="selectTheaterByAddr" resultType="com.movie.mymovie.dto.TheaterDto" parameterType="String">
	
	SELECT THEATER_ID, THEATER_NAME, THEATER_ADDR
	FROM THEATER
	WHERE THEATER_ADDR=#{theater_addr}
	
	</select>
<select id="selectDateByTheaterAndMovie" resultType="com.movie.mymovie.dto.TimeTableDto" parameterType="java.util.HashMap">
	
	SELECT DISTINCT  THEATER_ID, MOVIE_ID, TO_CHAR(MOVIE_DATETIME, 'yyyymmdd') AS MOVIE_DATETIME
	FROM TIMETABLE
	WHERE THEATER_ID =#{theater_id} AND MOVIE_ID=#{movie_id}
		
	</select>
	
	<select id="selectTimeByDate" resultType="com.movie.mymovie.dto.TimeTableDto" parameterType="java.util.HashMap">
		SELECT THEATER_ID, MOVIE_ID, TIMETABLE_ID, TO_CHAR(MOVIE_DATETIME, 'hh24:mi') AS MOVIE_DATETIME
		FROM TIMETABLE
		WHERE TO_CHAR(MOVIE_DATETIME,'YYYYMMDD') = #{movie_dateTime}
	</select>
	
	<select id="returnSeatList" resultType="java.util.Map" parameterType="java.util.HashMap">

		SELECT MAX(SCRHALL_SEATROW) AS SEATROW, MAX(SCRHALL_SEATCOL) AS SEATCOL
		FROM SCREENHALL
		WHERE THEATER_ID=#{theater_id} AND SCRHALL_ID=(SELECT SCRHALL_ID
                                   			FROM TIMETABLE
                                    		WHERE TIMETABLE_ID=#{timetable_id}
		)
	</select>
		
</mapper>